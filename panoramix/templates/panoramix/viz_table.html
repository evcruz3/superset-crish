{% macro viz_html(viz) %}
  {% if viz.request.args.get("async") == "true" %}
    {% set df = viz.get_df() %}
    <div class="table">
      <table class="dataframe table table-striped table-bordered table-condensed table-hover">
        <thead>
          <tr>
            {% for col in df.columns if not col.endswith('__perc') %}
              <th>{{ col }}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody>
          {% for row in df.to_dict(orient="records") %}
          <tr>
            {% for col in df.columns if not col.endswith('__perc') %}
              {% if col + '__perc' in df.columns %}
              <td style="background-image: linear-gradient(to right, lightgrey, lightgrey {{ row[col+'__perc'] }}%, rgba(0,0,0,0) {{ row[col+'__perc'] }}%">
                {{ row[col] }}
              </td>
              {% else %}
              <td>{{ row[col] }}</td>
              {% endif %}
            {% endfor %}
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% endif %}
{% endmacro %}

{% macro viz_js(viz) %}
{% endmacro %}

{% macro viz_css(viz) %}
{% endmacro %}
